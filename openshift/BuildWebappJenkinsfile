#!groovy

def call(Map<String, String> config) {
  pipeline {
    agent any

    environment {
      JAVA_TOOL_OPTIONS = '-Dfile.encoding=UTF-8'
    }

    stages {

      stage('Checkout Source') {
        steps {
          script {
            // Checkout application source
            git url: "${config.gitUrl}", branch: GIT_BRANCH

            def info = readJSON file: 'build-info.json'
            echo "${info}"
            buildVersion = "${info.appVersion}.${BUILD_NUMBER}"
            echo "${buildVersion}"
          }
        }
      }
    }
  }
}

